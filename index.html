<!doctype html>
<html>
    
    <head>
        <title>My experiment</title>
        <!-- Load jQuery -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <script src="scripts/raphael.js"></script>
        <!-- Load the jspsych library and plugins -->
        <script src="scripts/jspsych.js"></script>
        <script src="scripts/plugins/jspsych-text.js"></script>
        <script src="scripts/plugins/jspsych-single-stim.js"></script>
        <script src="scripts/plugins/subtractionStimPlugin.js"></script>
	<script src="scripts/underscore_min.js"></script>
	<script src="scripts/plugins/jspsych-twostim-tworesponse.js"></script>
        <!-- Load the stylesheet -->
        <link href="experiment.css" type="text/css" rel="stylesheet"></link>
    </head>
    
    <body>
        <div id="jspsych_target"></div>
    </body>
    
    <script type="text/javascript">
	
		/* Define all possible trials */
		var numMatrix = [
			['10','4','6','5','1','3'],
			['11','4','7','6','1','3'],
			['9','4','5','2','3','1'],
			['12','4','8','5','3','1'],
			['13','4','9','6','3','1',],
			['8','3','5','4','1','2'],
			['9','3','6','4','2','1'],
			['11','5','6','4','2','3'],
			['12','5','7','4','3','2'],
			['15','6','9','4','5','1'], 
			['11','5','6','4','2','3'],
			['13','5','8','6','2','3'],
			['14','5','9','7','2','3'],
			['12','5','7','4','3','2'],
			['14','5','9','6','3','2'],
			['15','5','10','7','3','2'],
			['12','5','7','3','4','1'],
			['15','5','10','6','4','1'],
			['16','5','11','7','4','1'],
			['9','3','6','5','1','2'],
			['10','4','6','5','1','3'],
			['10','3','7','5','2','1'],
			['13','6','7','5','2','4'],
			['12','4','8','5','3','1'],
			['15','7','8','5','3','4'],
			['15','6','9','5','4','2'],
			['16','7','9','5','4','3'],
			['18','7','11','5','6','1'],
			['14','6','8','7','1','5'],
			['15','6','9','8','1','5'],
			['13','6','7','5','2','4'],
			['15','6','9','7','2','4'],
			['16','6','10','8','2','4'],
			['15','6','9','5','4','2'],
			['17','6','11','7','4','2'],
			['18','6','12','8','4','2'],
			['15','6','9','4','5','1'],
			['18','6','12','7','5','1'],
			['19','6','13','8','5','1'],
			['11','4','7','6','1','3'],
			['12','5','7','6','1','4'],
			['13','5','8','6','2','3'],
			['15','7','8','6','2','5'],
			['13','4','9','6','3','1'],
			['14','5','9','6','3','2'],
			['16','7','9','6','3','4'],
			['17','8','9','6','3','5'],
			['15','5','10','6','4','1'],
			['17','8','9','6','3','5'],
			['15','5','10','6','4','1'],
			['17','7','10','6','4','3'],
			['18','7','11','6','5','2'],
			['19','8','11','6','5','3'],
			['21','8','13','6','7','1']
		];
		
//probes.length + times.length = 24 unique trial type presentations. There need to be 4 repetitions of each trial type presentation.  24 * 4 = 96 total trials.
		
		var probes = [1,2,3,4,5,6];
		var showProbe = probes[Math.floor(Math.random()*6)];
		
		var times = [500,1000,1500,2000];
		var pick_times = times[Math.floor(Math.random()*4)];
		
		var trials = []; 
		
		//instead of i increasing until numMatrix.length, should it not increase until the total number of trials is reached (96)?
		for (var i=0;i<96;i++) {
		var t = {};
		t.stimuli = [createStimulus(numMatrix[i]), createStimulus(numMatrix[i])];
		t.timing_first_stim = pick_times;
		trials.push(t);
		}
		
		//trials is an [] with 400 + elements
		//so, trials[10] is an object that looks like:
		//trials[10].stimuli = [stimulus1, stimulus2];
		//trials[10].timing_first_stim = 750;
		
		var experiment = [];
		for(var row = 0; row < trials.length; row++){
			var block = { 
				stimuli: trials[row].stimuli,
				timing_first_stim: trials[row].timing_first_stim
				};
		experiment.push(block);
		}
		        
        jsPsych.init({
            display_element: $('#jspsych_target'),
            experiment_structure: experiment,
            on_finish: function(data) {
                $("#jspsych_target").append($('<pre>', {
                    html: jsPsych.dataAsCSV()
                }));
                
                jsPsych.saveCSVdata("data.csv");
            }
        });
    </script>
</html>
